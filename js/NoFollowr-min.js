!function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=2)}([function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=window.jQuery,l={customEvent:"nf-change.nofollowr",togglerClass:"nf-moderator",noFollowClass:"nf-nofollow",loadingClass:"nf-loading",id:"nf-id"},i=function(){function t(){if(n(this,t),void 0===window.jbirchPlugin)throw new Error("WordPress has not provided the required configuration data.");this.options=window.jbirchPlugin,this.attachExternalLinksExpr()}return r(t,[{key:"init",value:function(){var t=this;a(this.options.postSelector).each(function(e,o){return t.attachPostsBehaviour(o)})}},{key:"getTitleAttr",value:function(t){return'Toggle link-love (currently "'+t+'"). Only admins see this.'}},{key:"removeNofollow",value:function(t){var e=t.attr("rel").replace(/\s?nofollow\s?/i,"");""===e?t.removeAttr("rel"):t.attr("rel",e)}},{key:"addNofollow",value:function(t){var e=t.attr("rel"),o=""===a.trim(e)?"nofollow":e+" nofollow";t.attr("rel",o)}},{key:"doUpdates",value:function(t){var e=a(t),o=this.changeLinks(e);this.updateTogglers(e,o)}},{key:"changeLinks",value:function(t){var e="follow";return this.hasRelNofollow(t)?this.removeNofollow(t):(this.addNofollow(t),e="nofollow"),e}},{key:"updateTogglers",value:function(t,e){var o=l.noFollowClass,n=l.togglerClass,r=l.loadingClass,a=t.next("."+n);a.toggleClass(o).removeClass(r).attr("title",this.getTitleAttr(e)),a.html("<span>"+e+"</span>")}},{key:"ajaxCallback",value:function(t){var e=window.jQuery.nofollowr.postData,o=e.postId,n=e.href;if("success"!==t)throw window.alert("Apologies, but something seems to be amiss. Your link is probably unaltered."),Error(t);a("#jbID-"+o).find('a[href="'+n+'"]').each(function(t,e){window.jQuery.nofollowr.doUpdates(e)})}},{key:"doAjax",value:function(){a.post(this.options.ajaxURL,this.postData,this.ajaxCallback)}},{key:"getPostId",value:function(t){return t.attr("id").split("-")[1]}},{key:"hasRelNofollow",value:function(t){return t.is('[rel~="nofollow"]')}},{key:"addToggler",value:function(t){var e=this,o=this.hasRelNofollow(t)?"nofollow":"follow";return a("<a>",{href:"#",title:this.getTitleAttr(o),html:"<span>"+o+"</span>",class:this.classesFor(o),click:function(t){return e.nfTogglerClickHandler(t)},data:{$externalLink:t}})}},{key:"classesFor",value:function(t){var e=l.togglerClass,o=l.noFollowClass;return"nofollow"===t?e+"  "+o:e}},{key:"nfTogglerClickHandler",value:function(t){t.preventDefault();var e=a(t.target),o=l.loadingClass,n=l.customEvent;if(e.is("."+o))return!1;var r=e.data(),i=r.$externalLink;return e.toggleClass(o).trigger(n,{href:i.attr("href"),changeToNofollow:!this.hasRelNofollow(i)}),!0}},{key:"attachExternalsBehaviour",value:function(t,e){var o=a(e);o.after(this.addToggler(o))}},{key:"isNumber",value:function(t){return!isNaN(t)}},{key:"validatePostId",value:function(t){return!(""===(t=String(t))||!this.isNumber(t))&&t}},{key:"handleNfChange",value:function(t,e){this.postData=e,this.doAjax()}},{key:"attachPostsBehaviour",value:function(t){var e=this,o=a(t),n=l.customEvent,r=this.validatePostId(this.getPostId(o));return r!==!1&&(o.on(n,function(t,o){var n=a.extend({},o,{postId:r});e.handleNfChange(t,n)}),this.findExternalLinks(o).each(this.attachExternalsBehaviour.bind(this)),!0)}},{key:"findExternalLinks",value:function(t){return t.find("a:nofollowCandidates")}},{key:"attachExternalLinksExpr",value:function(){a.expr[":"].nofollowCandidates=function(t){return!t.href.match(/^mailto:/)&&t.hostname!==window.location.hostname}}}]),t}(),s=window.jQuery.nofollowr=new i;a(document).ready(s.init.bind(s))},function(t,e){},function(t,e,o){o(0),t.exports=o(1)}]);